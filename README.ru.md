# Absolutify Paths Vite Plugin

üá¨üáß [English](README.md) | üá∑üá∫ [–†—É—Å—Å–∫–∏–π](README.ru.md)

–ü–ª–∞–≥–∏–Ω –¥–ª—è Vite, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å Hot Module Replacement (HMR) –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ WordPress —Ç–µ–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Vite. –ü–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ –≤ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã HMR –≤ WordPress.

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ WordPress —Ç–µ–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Vite, HMR –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ WordPress –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ Vite –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

## –†–µ—à–µ–Ω–∏–µ

–≠—Ç–æ—Ç –ø–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ –≤ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç HMR —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ WordPress.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ–π –≤ JSX/TSX —Ñ–∞–π–ª–∞—Ö
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ –∏–º–ø–æ—Ä—Ç–∞–º–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ CSS –º–æ–¥—É–ª–µ–π –∏ –¥—Ä—É–≥–∏—Ö –∞—Å—Å–µ—Ç–æ–≤

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
npm install absolutify-paths-vite-react
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–ª–∞–≥–∏–Ω –≤ –≤–∞—à `vite.config.ts`:

```typescript
import { defineConfig } from 'vite';
import { absolutifyPaths } from 'absolutify-paths-vite-react';

export default defineConfig({
  plugins: [
    absolutifyPaths({
      strings: [
        // –ü—Ä–∏–º–µ—Ä: –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏ –≤ –∞–±—Å–æ–ª—é—Ç–Ω—ã–π
        ['/wp-content/themes/your-theme/assets/', 'http://localhost:8080/']
      ],
      enforce: 'pre', // –ü–ª–∞–≥–∏–Ω –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–æ –¥—Ä—É–≥–∏—Ö –ø–ª–∞–≥–∏–Ω–æ–≤
      apply: 'serve'  // –ü–ª–∞–≥–∏–Ω –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
    })
  ]
});
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–ª–∞–≥–∏–Ω–∞:
   - `strings`: –º–∞—Å—Å–∏–≤ –ø–∞—Ä —Å—Ç—Ä–æ–∫ –¥–ª—è –∑–∞–º–µ–Ω—ã [–∏—Å—Ö–æ–¥–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞, —Ü–µ–ª–µ–≤–∞—è_—Å—Ç—Ä–æ–∫–∞]
   - `enforce`: –ø–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞–≥–∏–Ω–∞ ('pre' | 'post' | undefined)
   - `apply`: –∫–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å –ø–ª–∞–≥–∏–Ω ('serve' | 'build' | undefined)

## –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è WordPress —Ç–µ–º—ã —Å React

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import { absolutifyPaths } from 'absolutify-paths-vite-react';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [
    react(),
    absolutifyPaths({
      strings: [
        // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–∏ –ø—É—Ç–∏
        ['/wp-content/themes/your-theme/', 'http://localhost:5173/'],
        ['/wp-content/themes/your-theme/assets/', 'http://localhost:5173/assets/']
      ],
      enforce: 'pre',
      apply: 'serve'
    })
  ],
  server: {
    port: 5173,
    hmr: {
      host: 'localhost'
    }
  }
});
```

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

```tsx
// components/MyComponent.tsx
import { useState } from 'react';
import styles from './MyComponent.module.css';

export const MyComponent = () => {
  const [count, setCount] = useState(0);

  return (
    <div className={styles.container}>
      <h1>–°—á–µ—Ç—á–∏–∫: {count}</h1>
      <button onClick={() => setCount(count + 1)}>
        –£–≤–µ–ª–∏—á–∏—Ç—å
      </button>
    </div>
  );
};
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è WordPress —Ç–µ–º—ã

–î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è HMR –≤ –≤–∞—à–µ–π WordPress —Ç–µ–º–µ, –≤–∞–º –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç –≤ —Ñ–∞–π–ª `header.php` –≤–∞—à–µ–π —Ç–µ–º—ã:

```php
<!-- React HMR -->
<script type="module">
    import RefreshRuntime from "http://localhost:3000/@react-refresh"
    RefreshRuntime.injectIntoGlobalHook(window)
    window.$RefreshReg$ = () => {}
    window.$RefreshSig$ = () => (type) => type
    window.__vite_plugin_react_preamble_installed__ = true
</script>
<!-- /React HMR -->
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã React HMR –≤ WordPress. –û–Ω:
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç React Refresh runtime —Å –≤–∞—à–µ–≥–æ Vite dev —Å–µ—Ä–≤–µ—Ä–∞
- –í–Ω–µ–¥—Ä—è–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ HMR —Ö—É–∫–∏ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç window
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ç—Ä–µ–±—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ React Refresh –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
1. –†–∞–∑–º–µ—â–∞–µ—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –≤ —Å–µ–∫—Ü–∏–∏ `<head>` –≤–∞—à–µ–≥–æ `header.php`
2. –û–±–Ω–æ–≤–ª—è–µ—Ç–µ URL `localhost:3000` –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø–æ—Ä—Ç–æ–º –≤–∞—à–µ–≥–æ Vite dev —Å–µ—Ä–≤–µ—Ä–∞
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç–µ –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ `wp_head()` –ø–µ—Ä–µ–¥ —ç—Ç–∏–º —Å–∫—Ä–∏–ø—Ç–æ–º

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT 